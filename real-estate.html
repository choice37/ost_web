<!DOCTYPE HTML>
<!--
	Strongly Typed by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>ì•„íŒŒíŠ¸ ê°€ê²©ì§€ìˆ˜ ë¶„ì„ê¸° - Strongly Typed by HTML5 UP</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
		<style>
			/* ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ */
			.analysis-container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
			}
			
			.controls-section {
				background: #f8f9fa;
				padding: 25px;
				border-radius: 8px;
				margin-bottom: 30px;
				border: 1px solid #e9ecef;
				box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			}
			
			.controls-header {
				text-align: center;
				margin-bottom: 25px;
				border-bottom: 2px solid #e9ecef;
				padding-bottom: 15px;
			}
			
			.controls-header h3 {
				margin: 0;
				color: #333;
				font-size: 18px;
				font-weight: bold;
			}
			
			.controls-grid {
				display: grid;
				grid-template-columns: 200px 1fr 200px;
				gap: 25px;
				align-items: start;
			}
			
			.control-group {
				display: flex;
				flex-direction: column;
				min-height: 80px;
			}
			
			.control-group label {
				font-weight: bold;
				margin-bottom: 10px;
				color: #333;
				font-size: 14px;
			}
			
			.control-group select, .control-group button {
				padding: 12px;
				border: 2px solid #ddd;
				border-radius: 6px;
				font-size: 14px;
				transition: all 0.3s ease;
			}
			
			.control-group select:focus {
				border-color: #007bff;
				outline: none;
				box-shadow: 0 0 0 3px rgba(0,123,255,0.25);
			}
			
			.control-group button {
				background: #007bff;
				color: white;
				border: none;
				cursor: pointer;
				font-weight: bold;
				align-self: end;
				margin-top: auto;
			}
			
			.control-group button:hover {
				background: #0056b3;
				transform: translateY(-1px);
				box-shadow: 0 4px 8px rgba(0,0,0,0.2);
			}
			
			/* ì²´í¬ë°•ìŠ¤ ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ */
			.checkbox-grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
				gap: 8px;
				max-height: 250px;
				overflow-y: auto;
				padding: 15px;
				border: 2px solid #ddd;
				border-radius: 6px;
				background: white;
				box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
			}
			
			.checkbox-item {
				display: flex;
				align-items: center;
				padding: 10px;
				border-radius: 4px;
				transition: all 0.2s ease;
				border: 1px solid transparent;
			}
			
			.checkbox-item:hover {
				background-color: #f0f8ff;
				border-color: #007bff;
			}
			
			.checkbox-item input[type="checkbox"] {
				margin-right: 10px;
				transform: scale(1.3);
				cursor: pointer;
				accent-color: #007bff;
			}
			
			.checkbox-item label {
				cursor: pointer;
				font-weight: normal !important;
				margin: 0 !important;
				color: #333;
				user-select: none;
				font-size: 13px;
			}
			
			.selected-count {
				font-size: 12px;
				color: #666;
				margin-top: 8px;
				padding: 5px 10px;
				background: #f8f9fa;
				border-radius: 4px;
				text-align: center;
				font-weight: bold;
			}
			
			.chart-container {
				background: white;
				padding: 25px;
				border-radius: 8px;
				margin-bottom: 30px;
				box-shadow: 0 4px 12px rgba(0,0,0,0.1);
				border: 1px solid #e9ecef;
			}
			
			.stats-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
				gap: 20px;
				margin-bottom: 30px;
			}
			
			.stat-card {
				background: white;
				padding: 25px;
				border-radius: 8px;
				text-align: center;
				box-shadow: 0 4px 12px rgba(0,0,0,0.1);
				border: 1px solid #e9ecef;
				transition: transform 0.2s ease;
			}
			
			.stat-card:hover {
				transform: translateY(-2px);
				box-shadow: 0 8px 20px rgba(0,0,0,0.15);
			}
			
			.stat-value {
				font-size: 28px;
				font-weight: bold;
				color: #007bff;
				margin-bottom: 8px;
			}
			
			.stat-label {
				color: #666;
				font-size: 14px;
				font-weight: 600;
			}
			
			.stat-delta {
				font-size: 12px;
				margin-top: 5px;
				color: #28a745;
				font-weight: 500;
			}
			
			.data-table {
				width: 100%;
				border-collapse: collapse;
				margin-top: 20px;
				background: white;
				border-radius: 8px;
				overflow: hidden;
				box-shadow: 0 4px 12px rgba(0,0,0,0.1);
				border: 1px solid #e9ecef;
			}
			
			.data-table th,
			.data-table td {
				padding: 15px 12px;
				text-align: left;
				border-bottom: 1px solid #e9ecef;
			}
			
			.data-table th {
				background: #f8f9fa;
				font-weight: bold;
				color: #333;
				font-size: 14px;
			}
			
			.data-table tr:hover {
				background: #f0f8ff;
			}
			
			.data-table tr:last-child td {
				border-bottom: none;
			}
			
			.loading {
				text-align: center;
				padding: 40px;
				color: #666;
				font-size: 16px;
			}
			
			.error {
				background: #f8d7da;
				color: #721c24;
				padding: 15px 20px;
				border-radius: 6px;
				margin: 20px 0;
				border: 1px solid #f5c6cb;
			}
			
			.success {
				background: #d4edda;
				color: #155724;
				padding: 15px 20px;
				border-radius: 6px;
				margin: 20px 0;
				border: 1px solid #c3e6cb;
			}
			
			#multiSelectContainer {
				visibility: hidden;
				position: absolute;
				top: -9999px;
			}
			
			.section-title {
				font-size: 20px;
				font-weight: bold;
				color: #333;
				margin-bottom: 20px;
				padding-bottom: 10px;
				border-bottom: 2px solid #e9ecef;
			}
			
			@media (max-width: 768px) {
				.controls-grid {
					grid-template-columns: 1fr;
					gap: 20px;
				}
				.stats-grid {
					grid-template-columns: 1fr 1fr;
				}
				.checkbox-grid {
					grid-template-columns: 1fr;
				}
				.control-group {
					min-height: auto;
				}
			}
		</style>
	</head>
	<body class="left-sidebar is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<section id="header">
					<div class="container">

						<!-- Logo -->
							<h1 id="logo"><a href="index.html">ost personal blog</a></h1>
							<p>Blog for linking with external PCs</p>

						<!-- Nav -->
							<nav id="nav">
								<ul>
									<li><a class="icon solid fa-cog" href="index.html"><span>git data management</span></a></li>
									<li><a class="icon solid fa-home" href="real-estate.html"><span>real estate</span></a></li>
									<li><a class="icon solid fa-chart-line" href="stock.html"><span>stock</span></a></li>
									<li><a class="icon solid fa-heart" href="marriage.html"><span>marriage</span></a></li>
								</ul>
							</nav>

					</div>
				</section>

			<!-- Main -->
			<section id="main">
				<div class="analysis-container">
					<h1>ğŸ  ì§€ì—­ë³„ ì•„íŒŒíŠ¸ ê°€ê²©ì§€ìˆ˜ ì—°ë„ë³„ ìƒìŠ¹ë¥  ë¶„ì„</h1>
					<p style="text-align: center; color: #666; font-size: 16px;">ë¶€ë™ì‚° ì‹œì¥ íŠ¸ë Œë“œë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”!</p>
					
					<!-- ì»¨íŠ¸ë¡¤ ì˜ì—­ -->
					<div class="controls-section" id="analysisControls" style="display: none;">
						<div class="controls-header">
							<h3>ğŸ“Š ë¶„ì„ ì„¤ì •</h3>
						</div>
						<div class="controls-grid">
							<div class="control-group">
								<label for="analysisMode">ë¶„ì„ ëª¨ë“œ:</label>
								<select id="analysisMode" onchange="toggleAnalysisMode()">
									<option value="single">ë‹¨ì¼ ì§€ì—­ ë¶„ì„</option>
									<option value="compare">ì§€ì—­ ë¹„êµ ë¶„ì„</option>
								</select>
							</div>
							
							<div class="control-group" id="singleSelectContainer">
								<label for="regionSelect">ì§€ì—­ ì„ íƒ:</label>
								<select id="regionSelect">
									<option value="">ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”...</option>
								</select>
							</div>
							
							<div class="control-group" id="multiSelectContainer">
								<label for="regionCheckboxes">ë¹„êµ ì§€ì—­ ì„ íƒ (ìµœëŒ€ 5ê°œ):</label>
								<div id="regionCheckboxes" class="checkbox-grid">
									<!-- ì²´í¬ë°•ìŠ¤ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
								</div>
								<div class="selected-count" id="selectedCount">ì„ íƒëœ ì§€ì—­: 0ê°œ</div>
							</div>
							
							<div class="control-group">
								<button onclick="analyzeData()">ğŸ” ë¶„ì„ ì‹œì‘</button>
							</div>
						</div>
					</div>
					
					<!-- ë¡œë”©/ì—ëŸ¬ ë©”ì‹œì§€ -->
					<div id="loadingMessage" class="loading" style="display: none;">
						ğŸ“Š ë°ì´í„°ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...
					</div>
					
					<div id="errorMessage" class="error" style="display: none;"></div>
					<div id="successMessage" class="success" style="display: none;"></div>
					
					<!-- í†µê³„ ì •ë³´ -->
					<div id="statsSection" style="display: none;">
						<h2 class="section-title">ğŸ“ˆ ì£¼ìš” í†µê³„</h2>
						<div class="stats-grid" id="statsGrid"></div>
					</div>
					
					<!-- ì°¨íŠ¸ ì˜ì—­ -->
					<div id="chartSection" style="display: none;">
						<h2 class="section-title">ğŸ“Š ìƒìŠ¹ë¥  ì°¨íŠ¸</h2>
						<div class="chart-container">
							<canvas id="mainChart"></canvas>
						</div>
					</div>
					
					<!-- ë°ì´í„° í…Œì´ë¸” -->
					<div id="tableSection" style="display: none;">
						<h2 class="section-title">ğŸ“‹ ìƒì„¸ ë°ì´í„°</h2>
						<div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid #e9ecef;">
							<table class="data-table" id="dataTable">
								<thead id="tableHead"></thead>
								<tbody id="tableBody"></tbody>
							</table>
						</div>
					</div>
				</div>
			</section>

			<!-- Footer -->
				<section id="footer">
					<div id="copyright" class="container">
						<ul class="links">
							<li>&copy; ì•„íŒŒíŠ¸ ê°€ê²©ì§€ìˆ˜ ë¶„ì„ê¸°. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</div>
				</section>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			
			<script>
				// ì „ì—­ ë³€ìˆ˜
				let apartmentData = {};
				let regionsList = [];
				let currentChart = null;
				
				// í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ì—‘ì…€ íŒŒì¼ ë¡œë“œ
				window.addEventListener('DOMContentLoaded', function() {
					loadExcelFileAutomatically();
				});
				
				// ìë™ìœ¼ë¡œ ì—‘ì…€ íŒŒì¼ ë¡œë“œ
				function loadExcelFileAutomatically() {
					fetch('(ì›”) ì§€ì—­ë³„ ë§¤ë§¤ì§€ìˆ˜_ì•„íŒŒíŠ¸.xlsx')
						.then(response => {
							if (!response.ok) {
								throw new Error('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
							}
							return response.arrayBuffer();
						})
						.then(data => {
							try {
								const workbook = XLSX.read(data, { type: 'array' });
								
								// ì²« ë²ˆì§¸ ì‹œíŠ¸ ì‚¬ìš©
								const sheetName = workbook.SheetNames[0];
								const worksheet = workbook.Sheets[sheetName];
								
								// ì‹œíŠ¸ë¥¼ JSONìœ¼ë¡œ ë³€í™˜
								const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
								
								// ë°ì´í„° ì²˜ë¦¬
								processExcelData(jsonData);
								
								// ë¶„ì„ ì»¨íŠ¸ë¡¤ í‘œì‹œ
								document.getElementById('analysisControls').style.display = 'block';
								
							} catch (error) {
								console.error('ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
								showMessage('error', 'âŒ ì—‘ì…€ íŒŒì¼ì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
							}
						})
						.catch(error => {
							console.error('íŒŒì¼ ë¡œë“œ ì˜¤ë¥˜:', error);
							showMessage('error', 'âŒ ì—‘ì…€ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. "(ì›”) ì§€ì—­ë³„ ë§¤ë§¤ì§€ìˆ˜_ì•„íŒŒíŠ¸.xlsx" íŒŒì¼ì´ ê°™ì€ í´ë”ì— ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.');
						});
				}
				
				// ì—‘ì…€ ë°ì´í„° ì²˜ë¦¬
				function processExcelData(jsonData) {
					// ì²« ë²ˆì§¸ í–‰ì„ í—¤ë”ë¡œ ì‚¬ìš©
					const headers = jsonData[0];
					
					// ì¤‘ë³µëœ ì»¬ëŸ¼ëª… ì²˜ë¦¬
					const seen = {};
					const uniqueHeaders = [];
					for (let header of headers) {
						if (seen[header]) {
							seen[header]++;
							uniqueHeaders.push(`${header}_${seen[header]}`);
						} else {
							seen[header] = 0;
							uniqueHeaders.push(header);
						}
					}
					
					// ë°ì´í„° ë¶€ë¶„ë§Œ ì¶”ì¶œ (3ë²ˆì§¸ í–‰ë¶€í„°)
					const dataRows = jsonData.slice(2);
					
					// ì§€ì—­ë³„ ë°ì´í„° ì •ë¦¬
					apartmentData = {};
					regionsList = [];
					
					for (let row of dataRows) {
						if (!row[1] || row[1] === '') continue; // ì§€ì—­ ì»¬ëŸ¼ì´ ë¹„ì–´ìˆìœ¼ë©´ ìŠ¤í‚µ
						
						const region = row[1];
						if (!regionsList.includes(region)) {
							regionsList.push(region);
						}
						
						// ë‚ ì§œë³„ ë°ì´í„° ì •ë¦¬
						const monthlyData = {};
						
						for (let i = 3; i < uniqueHeaders.length; i++) { // 3ë²ˆì§¸ ì»¬ëŸ¼ë¶€í„° ë‚ ì§œ ë°ì´í„°
							const header = uniqueHeaders[i];
							const yearMonth = extractYearMonthFromColumn(header);
							
							if (yearMonth && row[i] !== undefined && row[i] !== '') {
								const year = yearMonth.year;
								const month = yearMonth.month;
								const value = parseFloat(row[i]);
								
								if (!isNaN(value)) {
									if (!monthlyData[year]) {
										monthlyData[year] = {};
									}
									monthlyData[year][month] = value;
								}
							}
						}
						
						// ì—°ë„ë³„ ìƒìŠ¹ë¥  ê³„ì‚°
						const yearlyGrowth = {};
						
						for (let year of Object.keys(monthlyData).sort()) {
							const yearData = monthlyData[year];
							if (Object.keys(yearData).length >= 2) {
								const months = Object.keys(yearData).map(Number).sort((a, b) => a - b);
								const minMonth = months[0];
								const maxMonth = months[months.length - 1];
								
								const startValue = yearData[minMonth];
								const endValue = yearData[maxMonth];
								
								if (startValue > 0) {
									const growthRate = ((endValue - startValue) / startValue) * 100;
									yearlyGrowth[year] = {
										growth_rate: Math.round(growthRate * 100) / 100,
										start_month: minMonth,
										end_month: maxMonth,
										start_value: Math.round(startValue * 10) / 10,
										end_value: Math.round(endValue * 10) / 10
									};
								}
							}
						}
						
						apartmentData[region] = yearlyGrowth;
					}
					
					// UI ì´ˆê¸°í™”
					initializeUI();
				}
				
				// ì»¬ëŸ¼ëª…ì—ì„œ ì—°ë„ì™€ ì›” ì¶”ì¶œ
				function extractYearMonthFromColumn(colName) {
					if (typeof colName !== 'string' || !colName.includes('ë…„') || !colName.includes('ì›”')) {
						return null;
					}
					
					const match = colName.match(/(\d{4})ë…„\s*(\d{1,2})ì›”/);
					if (match) {
						return {
							year: parseInt(match[1]),
							month: parseInt(match[2])
						};
					}
					
					return null;
				}
				
				// UI ì´ˆê¸°í™”
				function initializeUI() {
					const singleSelect = document.getElementById('regionSelect');
					const checkboxContainer = document.getElementById('regionCheckboxes');
					
					// ê¸°ì¡´ ì˜µì…˜ ì œê±°
					singleSelect.innerHTML = '<option value="">ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”...</option>';
					checkboxContainer.innerHTML = '';
					
					// ì§€ì—­ ì˜µì…˜ ì¶”ê°€
					regionsList.forEach(region => {
						// ë‹¨ì¼ ì„ íƒ
						const option = document.createElement('option');
						option.value = region;
						option.textContent = region;
						singleSelect.appendChild(option);
						
						// ì²´í¬ë°•ìŠ¤ ìƒì„±
						const checkboxItem = document.createElement('div');
						checkboxItem.className = 'checkbox-item';
						
						const checkbox = document.createElement('input');
						checkbox.type = 'checkbox';
						checkbox.id = `region_${region}`;
						checkbox.value = region;
						checkbox.addEventListener('change', updateSelectedCount);
						
						const label = document.createElement('label');
						label.htmlFor = `region_${region}`;
						label.textContent = region;
						
						checkboxItem.appendChild(checkbox);
						checkboxItem.appendChild(label);
						checkboxContainer.appendChild(checkboxItem);
					});
				}
				
				// ì„ íƒëœ ì§€ì—­ ìˆ˜ ì—…ë°ì´íŠ¸
				function updateSelectedCount() {
					const checkboxes = document.querySelectorAll('#regionCheckboxes input[type="checkbox"]:checked');
					const count = checkboxes.length;
					const countElement = document.getElementById('selectedCount');
					countElement.textContent = `ì„ íƒëœ ì§€ì—­: ${count}ê°œ`;
					
					// 5ê°œ ì´ìƒ ì„ íƒ ì‹œ ê²½ê³  ìƒ‰ìƒ
					if (count > 5) {
						countElement.style.color = '#dc3545';
						countElement.textContent = `ì„ íƒëœ ì§€ì—­: ${count}ê°œ (ìµœëŒ€ 5ê°œê¹Œì§€ ì„ íƒ ê°€ëŠ¥)`;
					} else {
						countElement.style.color = '#666';
					}
				}
				
				// ë¶„ì„ ëª¨ë“œ ì „í™˜
				function toggleAnalysisMode() {
					const mode = document.getElementById('analysisMode').value;
					const singleContainer = document.getElementById('singleSelectContainer');
					const multiContainer = document.getElementById('multiSelectContainer');
					
					if (mode === 'single') {
						singleContainer.style.visibility = 'visible';
						singleContainer.style.position = 'static';
						multiContainer.style.visibility = 'hidden';
						multiContainer.style.position = 'absolute';
						multiContainer.style.top = '-9999px';
					} else {
						singleContainer.style.visibility = 'hidden';
						singleContainer.style.position = 'absolute';
						singleContainer.style.top = '-9999px';
						multiContainer.style.visibility = 'visible';
						multiContainer.style.position = 'static';
					}
					
					// ê¸°ì¡´ ê²°ê³¼ ì´ˆê¸°í™”
					clearResults();
				}
				
				// ë°ì´í„° ë¶„ì„ ì‹¤í–‰
				function analyzeData() {
					const mode = document.getElementById('analysisMode').value;
					
					if (mode === 'single') {
						analyzeSingleRegion();
					} else {
						analyzeMultipleRegions();
					}
				}
				
				// ë‹¨ì¼ ì§€ì—­ ë¶„ì„
				function analyzeSingleRegion() {
					const selectedRegion = document.getElementById('regionSelect').value;
					
					if (!selectedRegion) {
						showMessage('error', 'ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
						return;
					}
					
					showLoading(true);
					
					setTimeout(() => {
						const regionData = apartmentData[selectedRegion];
						
						if (!regionData || Object.keys(regionData).length === 0) {
							showMessage('error', 'ì„ íƒí•œ ì§€ì—­ì˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
							showLoading(false);
							return;
						}
						
						// ì°¨íŠ¸ ìƒì„±
						createSingleRegionChart(selectedRegion, regionData);
						
						// í†µê³„ ì •ë³´ í‘œì‹œ
						displayStats(selectedRegion, regionData);
						
						// ë°ì´í„° í…Œì´ë¸” í‘œì‹œ
						displayDataTable(selectedRegion, regionData);
						
						showLoading(false);
						showMessage('success', `${selectedRegion} ì§€ì—­ ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
					}, 500);
				}
				
				// ë‹¤ì¤‘ ì§€ì—­ ë¶„ì„
				function analyzeMultipleRegions() {
					const checkboxes = document.querySelectorAll('#regionCheckboxes input[type="checkbox"]:checked');
					const selectedRegions = Array.from(checkboxes).map(cb => cb.value);
					
					if (selectedRegions.length < 2) {
						showMessage('error', 'ë¹„êµë¥¼ ìœ„í•´ ìµœì†Œ 2ê°œ ì§€ì—­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
						return;
					}
					
					if (selectedRegions.length > 5) {
						showMessage('error', 'ìµœëŒ€ 5ê°œ ì§€ì—­ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
						return;
					}
					
					showLoading(true);
					
					setTimeout(() => {
						const regionsData = {};
						selectedRegions.forEach(region => {
							if (apartmentData[region]) {
								regionsData[region] = apartmentData[region];
							}
						});
						
						if (Object.keys(regionsData).length === 0) {
							showMessage('error', 'ì„ íƒí•œ ì§€ì—­ë“¤ì˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
							showLoading(false);
							return;
						}
						
						// ë¹„êµ ì°¨íŠ¸ ìƒì„±
						createComparisonChart(regionsData);
						
						// ë¹„êµ í†µê³„ í‘œì‹œ
						displayComparisonStats(regionsData);
						
						// ë¹„êµ í…Œì´ë¸” í‘œì‹œ
						displayComparisonTable(regionsData);
						
						showLoading(false);
						showMessage('success', `${selectedRegions.length}ê°œ ì§€ì—­ ë¹„êµ ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
					}, 500);
				}
				
				// ë‹¨ì¼ ì§€ì—­ ì°¨íŠ¸ ìƒì„±
				function createSingleRegionChart(region, data) {
					const ctx = document.getElementById('mainChart').getContext('2d');
					
					if (currentChart) {
						currentChart.destroy();
					}
					
					const years = Object.keys(data).map(Number).sort();
					const growthRates = years.map(year => data[year].growth_rate);
					
					const colors = growthRates.map(rate => rate >= 0 ? '#4ECDC4' : '#FF6B6B');
					
					currentChart = new Chart(ctx, {
						type: 'bar',
						data: {
							labels: years,
							datasets: [{
								label: 'ìƒìŠ¹ë¥  (%)',
								data: growthRates,
								backgroundColor: colors,
								borderColor: colors,
								borderWidth: 1
							}]
						},
						options: {
							responsive: true,
							plugins: {
								title: {
									display: true,
									text: `ğŸ  ${region} ì§€ì—­ ì—°ë„ë³„ ì•„íŒŒíŠ¸ ê°€ê²©ì§€ìˆ˜ ìƒìŠ¹ë¥ `,
									font: {
										size: 16,
										weight: 'bold'
									}
								},
								legend: {
									display: false
								}
							},
							scales: {
								y: {
									beginAtZero: true,
									title: {
										display: true,
										text: 'ìƒìŠ¹ë¥  (%)'
									},
									grid: {
										color: 'rgba(0,0,0,0.1)'
									}
								},
								x: {
									title: {
										display: true,
										text: 'ì—°ë„'
									}
								}
							},
							plugins: {
								tooltip: {
									callbacks: {
										label: function(context) {
											const year = context.label;
											const yearData = data[year];
											return [
												`ìƒìŠ¹ë¥ : ${context.parsed.y.toFixed(1)}%`,
												`ê¸°ê°„: ${yearData.start_month}ì›” â†’ ${yearData.end_month}ì›”`,
												`ì§€ìˆ˜: ${yearData.start_value} â†’ ${yearData.end_value}`
											];
										}
									}
								}
							}
						}
					});
					
					document.getElementById('chartSection').style.display = 'block';
				}
				
				// ë¹„êµ ì°¨íŠ¸ ìƒì„±
				function createComparisonChart(regionsData) {
					const ctx = document.getElementById('mainChart').getContext('2d');
					
					if (currentChart) {
						currentChart.destroy();
					}
					
					// ëª¨ë“  ì—°ë„ ìˆ˜ì§‘
					const allYears = new Set();
					Object.values(regionsData).forEach(data => {
						Object.keys(data).forEach(year => allYears.add(Number(year)));
					});
					const sortedYears = Array.from(allYears).sort();
					
					// ìƒ‰ìƒ íŒ”ë ˆíŠ¸
					const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7'];
					
					// ë°ì´í„°ì…‹ ìƒì„±
					const datasets = Object.keys(regionsData).map((region, index) => {
						const data = sortedYears.map(year => {
							return regionsData[region][year] ? regionsData[region][year].growth_rate : null;
						});
						
						return {
							label: region,
							data: data,
							borderColor: colors[index % colors.length],
							backgroundColor: colors[index % colors.length] + '20',
							fill: false,
							tension: 0.1,
							pointRadius: 4,
							pointHoverRadius: 6
						};
					});
					
					currentChart = new Chart(ctx, {
						type: 'line',
						data: {
							labels: sortedYears,
							datasets: datasets
						},
						options: {
							responsive: true,
							plugins: {
								title: {
									display: true,
									text: 'ğŸ  ì§€ì—­ë³„ ì•„íŒŒíŠ¸ ê°€ê²©ì§€ìˆ˜ ì—°ë„ë³„ ìƒìŠ¹ë¥  ë¹„êµ',
									font: {
										size: 16,
										weight: 'bold'
									}
								}
							},
							scales: {
								y: {
									beginAtZero: true,
									title: {
										display: true,
										text: 'ìƒìŠ¹ë¥  (%)'
									},
									grid: {
										color: 'rgba(0,0,0,0.1)'
									}
								},
								x: {
									title: {
										display: true,
										text: 'ì—°ë„'
									}
								}
							}
						}
					});
					
					document.getElementById('chartSection').style.display = 'block';
				}
				
				// í†µê³„ ì •ë³´ í‘œì‹œ
				function displayStats(region, data) {
					const growthRates = Object.values(data).map(d => d.growth_rate);
					const avgRate = growthRates.reduce((a, b) => a + b, 0) / growthRates.length;
					const maxRate = Math.max(...growthRates);
					const minRate = Math.min(...growthRates);
					
					const maxYear = Object.keys(data).find(year => data[year].growth_rate === maxRate);
					const minYear = Object.keys(data).find(year => data[year].growth_rate === minRate);
					
					const statsHTML = `
						<div class="stat-card">
							<div class="stat-value">${avgRate.toFixed(2)}%</div>
							<div class="stat-label">í‰ê·  ìƒìŠ¹ë¥ </div>
							<div class="stat-delta">${avgRate > 0 ? 'ìƒìŠ¹' : 'í•˜ë½'}</div>
						</div>
						<div class="stat-card">
							<div class="stat-value">${maxRate.toFixed(2)}%</div>
							<div class="stat-label">ìµœëŒ€ ìƒìŠ¹ë¥ </div>
							<div class="stat-delta">${maxYear}ë…„</div>
						</div>
						<div class="stat-card">
							<div class="stat-value">${minRate.toFixed(2)}%</div>
							<div class="stat-label">ìµœì†Œ ìƒìŠ¹ë¥ </div>
							<div class="stat-delta">${minYear}ë…„</div>
						</div>
						<div class="stat-card">
							<div class="stat-value">${Object.keys(data).length}</div>
							<div class="stat-label">ë¶„ì„ ì—°ë„ ìˆ˜</div>
							<div class="stat-delta">ë…„</div>
						</div>
					`;
					
					document.getElementById('statsGrid').innerHTML = statsHTML;
					document.getElementById('statsSection').style.display = 'block';
				}
				
				// ë¹„êµ í†µê³„ í‘œì‹œ
				function displayComparisonStats(regionsData) {
					const statsHTML = Object.keys(regionsData).map(region => {
						const data = regionsData[region];
						const growthRates = Object.values(data).map(d => d.growth_rate);
						const avgRate = growthRates.reduce((a, b) => a + b, 0) / growthRates.length;
						
						return `
							<div class="stat-card">
								<div class="stat-value">${avgRate.toFixed(2)}%</div>
								<div class="stat-label">${region}</div>
								<div class="stat-delta">í‰ê·  ìƒìŠ¹ë¥ </div>
							</div>
						`;
					}).join('');
					
					document.getElementById('statsGrid').innerHTML = statsHTML;
					document.getElementById('statsSection').style.display = 'block';
				}
				
				// ë°ì´í„° í…Œì´ë¸” í‘œì‹œ
				function displayDataTable(region, data) {
					const tableHead = document.getElementById('tableHead');
					const tableBody = document.getElementById('tableBody');
					
					// í…Œì´ë¸” í—¤ë”
					tableHead.innerHTML = `
						<tr>
							<th>ì—°ë„</th>
							<th>ì‹œì‘ì›”</th>
							<th>ì¢…ë£Œì›”</th>
							<th>ì‹œì‘ê°’</th>
							<th>ì¢…ë£Œê°’</th>
							<th>ìƒìŠ¹ë¥ </th>
							<th>ìƒìŠ¹/í•˜ë½</th>
						</tr>
					`;
					
					// í…Œì´ë¸” ë°”ë””
					const sortedYears = Object.keys(data).sort();
					const tableRows = sortedYears.map(year => {
						const yearData = data[year];
						const isIncrease = yearData.growth_rate > 0;
						
						return `
							<tr>
								<td>${year}</td>
								<td>${yearData.start_month}ì›”</td>
								<td>${yearData.end_month}ì›”</td>
								<td>${yearData.start_value}</td>
								<td>${yearData.end_value}</td>
								<td>${yearData.growth_rate.toFixed(2)}%</td>
								<td>${isIncrease ? 'ğŸ“ˆ ìƒìŠ¹' : 'ğŸ“‰ í•˜ë½'}</td>
							</tr>
						`;
					}).join('');
					
					tableBody.innerHTML = tableRows;
					document.getElementById('tableSection').style.display = 'block';
				}
				
				// ë¹„êµ í…Œì´ë¸” í‘œì‹œ
				function displayComparisonTable(regionsData) {
					const tableHead = document.getElementById('tableHead');
					const tableBody = document.getElementById('tableBody');
					
					// í…Œì´ë¸” í—¤ë”
					tableHead.innerHTML = `
						<tr>
							<th>ì§€ì—­</th>
							<th>í‰ê·  ìƒìŠ¹ë¥ </th>
							<th>ìµœëŒ€ ìƒìŠ¹ë¥ </th>
							<th>ìµœì†Œ ìƒìŠ¹ë¥ </th>
							<th>ë¶„ì„ ì—°ë„</th>
						</tr>
					`;
					
					// í…Œì´ë¸” ë°”ë””
					const tableRows = Object.keys(regionsData).map(region => {
						const data = regionsData[region];
						const growthRates = Object.values(data).map(d => d.growth_rate);
						const avgRate = growthRates.reduce((a, b) => a + b, 0) / growthRates.length;
						const maxRate = Math.max(...growthRates);
						const minRate = Math.min(...growthRates);
						
						return `
							<tr>
								<td>${region}</td>
								<td>${avgRate.toFixed(2)}%</td>
								<td>${maxRate.toFixed(2)}%</td>
								<td>${minRate.toFixed(2)}%</td>
								<td>${Object.keys(data).length}ë…„</td>
							</tr>
						`;
					}).join('');
					
					tableBody.innerHTML = tableRows;
					document.getElementById('tableSection').style.display = 'block';
				}
				
				// ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
				function showLoading(show) {
					document.getElementById('loadingMessage').style.display = show ? 'block' : 'none';
				}
				
				function showMessage(type, message) {
					const errorEl = document.getElementById('errorMessage');
					const successEl = document.getElementById('successMessage');
					
					errorEl.style.display = 'none';
					successEl.style.display = 'none';
					
					if (type === 'error') {
						errorEl.textContent = message;
						errorEl.style.display = 'block';
						setTimeout(() => errorEl.style.display = 'none', 5000);
					} else if (type === 'success') {
						successEl.textContent = message;
						successEl.style.display = 'block';
						setTimeout(() => successEl.style.display = 'none', 3000);
					}
				}
				
				function clearResults() {
					document.getElementById('statsSection').style.display = 'none';
					document.getElementById('chartSection').style.display = 'none';
					document.getElementById('tableSection').style.display = 'none';
					
					if (currentChart) {
						currentChart.destroy();
						currentChart = null;
					}
				}
			</script>

	</body>
</html>
